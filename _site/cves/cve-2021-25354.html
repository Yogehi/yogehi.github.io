<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CVE-2021-25354 Details | YayWebsiteYay (I suck at titles)</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CVE-2021-25354 Details" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometimes I want to publish stuff unfiltered." />
<meta property="og:description" content="Sometimes I want to publish stuff unfiltered." />
<link rel="canonical" href="http://localhost:4000/cves/cve-2021-25354" />
<meta property="og:url" content="http://localhost:4000/cves/cve-2021-25354" />
<meta property="og:site_name" content="YayWebsiteYay (I suck at titles)" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2021-25354 Details" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"CVE-2021-25354 Details","description":"Sometimes I want to publish stuff unfiltered.","url":"http://localhost:4000/cves/cve-2021-25354","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="YayWebsiteYay (I suck at titles)" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">YayWebsiteYay (I suck at titles)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/published-research/">Published Research</a><a class="page-link" href="/cves/">My CVEs</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">CVE-2021-25354 Details</h1>
  </header>

  <div class="post-content">
    <h4 id="original-post-httpslabsf-securecomadvisoriesopen-activities-via-samsung-browser">Original post: <a href="https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/">https://labs.f-secure.com/advisories/open-activities-via-samsung-browser/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Android devices with Samsung Internet (prior to version 13.2.1.46)</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Medium</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2021-25354</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Application Security Bypass</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung S20 device for Tokyo Pwn2Own 2020. An issue was discovered that allowed a specific browsable intent in Samsung Browser (com.sec.android.app.sbrowser) to either:</p>

<ul>
  <li>Launch non-exported activities in the Samsung Browser application</li>
  <li>Launch an exported activity in any installed application</li>
</ul>

<p>Note that while this issue was found on a Samsung Galaxy device, the Samsung Internet browser application is available on the Google Play store and can be installed on any Android device with access to said store. It was confirmed that this issue could be exploited on any Android device that had the Samsung Internet application installed.</p>

<h2 id="technical-details">Technical Details</h2>

<p>The issue is due to the class <code class="language-plaintext highlighter-rouge">com.sec.android.app.sbrowser.capsule.BixbySBrowserLauncherActivity</code> methods <code class="language-plaintext highlighter-rouge">handleIntent</code> and <code class="language-plaintext highlighter-rouge">handleShareVia</code>. First, <code class="language-plaintext highlighter-rouge">handleIntent</code> does the following:</p>

<ul>
  <li>Parses the passed intent and establishes the URI <code class="language-plaintext highlighter-rouge">data</code> from the intent’s data</li>
  <li>Parses the URI <code class="language-plaintext highlighter-rouge">data</code> and establishes the list <code class="language-plaintext highlighter-rouge">pathSegments</code> from the URI’s path segments</li>
  <li>If the first item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> is <code class="language-plaintext highlighter-rouge">ShareVia</code>, then the method <code class="language-plaintext highlighter-rouge">handleShareVia</code> is executed</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void handleIntent(final Intent intent) {
    final String action = intent.getAction();
    final Uri data = intent.getData();
    int n = 1;
    if ("android.intent.action.VIEW".equals(action) &amp;&amp; data != null) {
        final String string = data.toString();
        final List pathSegments = data.getPathSegments();
        if ((this.mPathSegments = (List&lt;String&gt;)pathSegments) != null) {
            if (pathSegments.size() != 0) {
                final String pathSegments2 = this.getPathSegments(0);
                if (pathSegments2 == null) {
                    return;
                }
            Label_0738: {
                switch (pathSegments2.hashCode()) {
                ...
                    case -679124017: {
                        if (pathSegments2.equals("ShareVia")) {
                            n = 4;
                            break Label_0738;
                        }
                        break;
                }
                ...
            switch (n) {
                ...
                case 4: {
                    this.handleShareVia();
                    break;
                }
</code></pre></div></div>

<p>Next, <code class="language-plaintext highlighter-rouge">handleShareVia</code> does the following:</p>

<ul>
  <li>Creates a new intent <code class="language-plaintext highlighter-rouge">createIntentWithTargetTask</code></li>
  <li>Checks if the second item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> is <code class="language-plaintext highlighter-rouge">result_type_success</code></li>
  <li>Checks if the third and fouth items in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> are not null</li>
  <li>If the fourth item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code> is not <code class="language-plaintext highlighter-rouge">com.sec.android.app.sbrowser.ReceiveWeChatMomentActivity</code>, then assign the following <code class="language-plaintext highlighter-rouge">createIntetWithTargetTask</code> extra values:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">packageName</code> = the third item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code></li>
      <li><code class="language-plaintext highlighter-rouge">activityName</code> = the fourth item in the list <code class="language-plaintext highlighter-rouge">pathSegments</code></li>
    </ul>
  </li>
  <li>Start the activity outlined in the intent <code class="language-plaintext highlighter-rouge">createIntentWithTargetTask</code></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private void handleShareVia() {
    String pathSegments = getPathSegments(1);
    if (pathSegments != null) {
        Intent createIntentWithTargetTask = createIntentWithTargetTask("com.sec.android.app.sbrowser.INTENT_SHARE_VIA");
        createIntentWithTargetTask.putExtra("resultType", pathSegments);
        if ("result_type_success".equals(pathSegments)) {
            String pathSegments2 = getPathSegments(2);
            String pathSegments3 = getPathSegments(3);
            if (pathSegments2 != null &amp;&amp; pathSegments3 != null) {
                if (pathSegments3.equals("com.sec.android.app.sbrowser.ReceiveWeChatMomentActivity") &amp;&amp; !this.isWeChatAvailable()) {
                    Log.d("BixbyLauncherActivity", "WeChat is not installed!");
                    createIntentWithTargetTask.putExtra("resultType", "result_type_fail");
                } else {
                    createIntentWithTargetTask.putExtra("packageName", pathSegments2);
                    createIntentWIthTargetTask.putExtra("activityName", pathSegments3);
                }
            } else {
                return;
            }
        ...
        try {
            getApplicationContext().startActivity(createIntentWithTargetTask);
        } catch (ActivityNotFoundException e) {
            Log.d("BixbyLauncherActivity", "[handleShareVia]" + e.toString());
        }
    }
}
</code></pre></div></div>

<p>Using this information, it is possible to create a custom intent that launches a specific activity:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/&lt;package name&gt;/&lt;activity name&gt;
</code></pre></div></div>

<p>The following example browsable intent link will launch the non-exported component <code class="language-plaintext highlighter-rouge">com.sec.android.app.sbrowser/com.google.zxing.client.android.SecCaptureActivity</code> in the Samsung Browser application:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;a href="intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/com.sec.android.app.sbrowser/com.google.zxing.client.android.SecCaptureActivity/#Intent;scheme=samsunginternet;action=android.intent.action.VIEW;package=com.sec.android.app.sbrowser;end"&gt;click here&lt;/a&gt;
</code></pre></div></div>

<p>By replacing the appropriate fields, it is also possible to launch activities that are exported in other applications. The following browsable intent link will launch the exported component <code class="language-plaintext highlighter-rouge">com.sec.android.app.myfiles/com.sec.android.app.myfiles.external.ui.PickerActivity</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;a href="intent://com.sec.android.app.sbrowser/ShareVia/result_type_success/com.sec.android.app.myfiles/com.sec.android.app.myfiles.external.ui.PickerActivity/#Intent;scheme=samsunginternet;action=android.intent.action.VIEW;package=com.sec.android.app.sbrowser;end"&gt;click here&lt;/a&gt;
</code></pre></div></div>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released Samsung Browser version 13.2.1.46 which fixes the issue outlined in this advisory. F-Secure recommends that users upgrade Samsung Browser to at least version 13.2.1.46.</p>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>02/11/2020</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>02/11/2020</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>12/01/2021</td>
      <td>Follow up sent to Samsung</td>
    </tr>
    <tr>
      <td>17/01/2021</td>
      <td>Samsung confirms the vulnerability and rates it as a moderate risk issue</td>
    </tr>
    <tr>
      <td>09/02/2021</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>25/03/2021</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>26/03/2021</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">YayWebsiteYay (I suck at titles)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">YayWebsiteYay (I suck at titles)</li><li><a class="u-email" href="mailto:Fake_email_link">Fake_email_link</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">yogehi</span></a></li><li><a href="https://www.twitter.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">yogehi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Sometimes I want to publish stuff unfiltered.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
