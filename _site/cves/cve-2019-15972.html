<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CVE-2019-15972 Details | YayWebsiteYay (I suck at titles)</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CVE-2019-15972 Details" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Sometimes I want to publish stuff unfiltered." />
<meta property="og:description" content="Sometimes I want to publish stuff unfiltered." />
<link rel="canonical" href="http://localhost:4000/cves/cve-2019-15972" />
<meta property="og:url" content="http://localhost:4000/cves/cve-2019-15972" />
<meta property="og:site_name" content="YayWebsiteYay (I suck at titles)" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CVE-2019-15972 Details" />
<script type="application/ld+json">
{"@type":"WebPage","headline":"CVE-2019-15972 Details","url":"http://localhost:4000/cves/cve-2019-15972","description":"Sometimes I want to publish stuff unfiltered.","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="YayWebsiteYay (I suck at titles)" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">YayWebsiteYay (I suck at titles)</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/published-research/">Published Research</a><a class="page-link" href="/cves/">My CVEs</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">CVE-2019-15972 Details</h1>
  </header>

  <div class="post-content">
    <h4 id="original-post-httpslabsf-securecomadvisoriescisco-ucm-informix-sql-injection">Original post: <a href="https://labs.f-secure.com/advisories/cisco-ucm-informix-sql-injection/">https://labs.f-secure.com/advisories/cisco-ucm-informix-sql-injection/</a></h4>

<table>
  <tbody>
    <tr>
      <td><strong>Product</strong></td>
      <td>Cisco Unified Call Manager (UCM) Administrator Portal version 11.5.1.14900-11, other versions may be affected</td>
    </tr>
    <tr>
      <td><strong>Severity</strong></td>
      <td>Medium</td>
    </tr>
    <tr>
      <td><strong>CVE Reference</strong></td>
      <td>CVE-2019-15972</td>
    </tr>
    <tr>
      <td><strong>Type</strong></td>
      <td>SQL Injection</td>
    </tr>
  </tbody>
</table>

<h2 id="description">Description</h2>

<p>A SQL Injection vulnerability was discovered in the Cisco Unified Call Manager (UCM) administrator portal. An authenticated user can utilize this vulnerability to enumerate the entire database that is used by Cisco UCM. This includes any secrets, such as password hashes.</p>

<p>The SQL Injection issue was found in several areas of the application. Below is a URL that was used to discover the first injection point. The GET parameter <code class="language-plaintext highlighter-rouge">whereClause</code> contained the SQL Injection payload:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://&lt;cucm_admin_portal&gt;/ccmadmin/userGroupFindList.do?searchLimVal3=&amp;searchLimVal4=&amp;whereClause=1=1 AND (select ascii(substring(tabname from 1 for 1)) FROM systables where tabid = 1) &gt; 64&amp;searchLimVal1=&amp;searchLimVal2=&amp;searchLimVal7=&amp;searchLimVal8=&amp;searchLimVal5=&amp;search LimVal6=&amp;rowsPerPageControl=/ccmadmin/userGroupFindList.do?lookup=true&amp;colCnt=4&amp;searchLimVal0=&amp;lookup=true&amp;rowsPerPage=50&amp;searchLimVal9=&amp;pageNumber=1&amp;recCnt=37&amp;multiple=true
</code></pre></div></div>

<p>The above SQL statement can be broken down into the following:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">1=1 AND</code> - establishes a true statement and forces the underlying SQL query to include the proceeding SQL statement.</li>
  <li><code class="language-plaintext highlighter-rouge">select asci(substring(tabname from 1 for 1)) FROM systables where tabid = 1</code> - In Informix SQL, all table names, called <code class="language-plaintext highlighter-rouge">tabname</code>, are kept in a table called <code class="language-plaintext highlighter-rouge">systables</code> and are assigned a unique ID value, <code class="language-plaintext highlighter-rouge">tabid</code>. This portion of the SQL statement looks for the first table name, looks at the first letter of the name and converts the value to the equivalent ASCII character value.</li>
  <li><code class="language-plaintext highlighter-rouge">&gt; 64</code> - evaluates if the ASCII character value generated from the preceding SQL statement is greater than 64.</li>
</ul>

<p>This SQL Injection was classified as a Blind Boolean injection, with server’s response size dependent on if the injected SQL statement returns a true or false response. By going through each letter, it is possible to enumerate the underlying tables, columns and entries.</p>

<h2 id="multiple-injection-points">Multiple Injection Points</h2>

<p>The above SQL Injection point was discovered and verified with the tool SQLMap, and the backend database was confirmed to be Informix. After the initial discovery, several other injection points, undetectable by SQLMap, were manually discovered.</p>

<p>After the initial disclosure to Cisco, their internal team also verified additional SQL Injection points throughout the application.</p>

<h2 id="custom-tool-exploitation">Custom Tool Exploitation</h2>

<p>As stated, SQLMap could be used to discover and verify the above Informix SQL Injection point. However, SQLMap could not be used to do the following:</p>

<ul>
  <li>Extract contents of the underlying database</li>
  <li>Discover or confirm any other SQL Injection point within the application</li>
</ul>

<p>F-Secure created some scripts that can be used to fully exploit this issue. It relies on the above SQL Injection point, but the scripts can be modified to work with any other SQL Injection point.</p>

<ul>
  <li>The scripts are available here: <a href="https://github.com/Yogehi/Cisco-UCM-SQLi-Scripts">https://github.com/Yogehi/Cisco-UCM-SQLi-Scripts</a></li>
  <li>A description on how F-Secure fully exploited this issue is available here: <a href="https://labs.f-secure.com/blog/uncommon-sql-database-alert-informix-sql-injection">https://labs.f-secure.com/blog/uncommon-sql-database-alert-informix-sql-injection</a></li>
</ul>

<h2 id="remediation-and-mitigation">Remediation and Mitigation</h2>

<p>At the time of this advisory’s posting, Cisco is working on releasing the following patches to the UCM application that will resolve this issue:</p>

<ul>
  <li>UCM version 11.5.2SU7</li>
  <li>UCM version 12.5.1SU2</li>
</ul>

<p>If upgrading UCM to the above versions is not possible, the following mitigations are recommended:</p>

<p>Use UCM’s LDAP login feature to manage who can login into UCM</p>

<ul>
  <li>Audit the current list of users who can login into UCM</li>
  <li>Monitor network traffic to/from the UCM application to see if this vulnerability is being exploited</li>
</ul>

<h2 id="timeline">Timeline</h2>

<table>
  <tbody>
    <tr>
      <td><strong>Date</strong></td>
      <td><strong>Summary</strong></td>
    </tr>
    <tr>
      <td>26/04/2019</td>
      <td>Issue reported to vendor</td>
    </tr>
    <tr>
      <td>07/05/2019</td>
      <td>Vendor responded, requested additional details</td>
    </tr>
    <tr>
      <td>07/05/2019</td>
      <td>Additional details sent</td>
    </tr>
    <tr>
      <td>22/05/2019</td>
      <td>Vendor responded, internal analysis still in progress</td>
    </tr>
    <tr>
      <td>11/06/2019</td>
      <td>Vendor responded, vulnerability confirmed in multiple versions of UCM</td>
    </tr>
    <tr>
      <td>14/06/2019</td>
      <td>Vendor responded, internal teams engaged to determine if other products are affected</td>
    </tr>
    <tr>
      <td>14/06/2019</td>
      <td>Informed vendor of client pre-release disclosure</td>
    </tr>
    <tr>
      <td>14/09/2019</td>
      <td>Vendor responded, approved of client pre-release disclosure</td>
    </tr>
    <tr>
      <td>25/09/2019</td>
      <td>F-Secure and vendor agree to a joint public disclosure date of 20 November</td>
    </tr>
    <tr>
      <td>20/11/2019</td>
      <td>Public disclosure</td>
    </tr>
  </tbody>
</table>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">YayWebsiteYay (I suck at titles)</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">YayWebsiteYay (I suck at titles)</li><li><a class="u-email" href="mailto:Fake_email_link">Fake_email_link</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">yogehi</span></a></li><li><a href="https://www.twitter.com/yogehi"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">yogehi</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Sometimes I want to publish stuff unfiltered.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
